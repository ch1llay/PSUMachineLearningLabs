# GTZAN Dataset — Описание признаков

Датасет содержит 1000 аудиозаписей (по 30 секунд), разбитых на 10 жанров по 100 штук.
Каждая запись представлена 60 столбцами: имя файла, длина, 57 числовых аудиопризнаков и метка жанра.

Все признаки извлечены библиотекой **librosa** — стандартом для анализа аудио в Python.
Для каждого признака хранятся два значения: **mean** (среднее по всем фреймам 30-секундного клипа) и **var** (дисперсия — насколько признак менялся по ходу записи).

---

## Служебные столбцы

| Столбец | Описание |
|---------|----------|
| `filename` | Имя wav-файла, например `blues.00000.wav` |
| `length` | Длина аудио в сэмплах (~661 794 при частоте дискретизации 22 050 Гц = ~30 сек) |
| `label` | Жанр: blues, classical, country, disco, hiphop, jazz, metal, pop, reggae, rock |

---

## 1. chroma_stft — Хромаграмма (STFT)

### Что это
Хромаграмма показывает, какие из **12 нот** (C, C#, D, D#, E, F, F#, G, G#, A, A#, B) звучат в каждый момент времени. Берётся спектрограмма (STFT), и все частоты «сворачиваются» в 12 полутоновых классов — все октавы одной ноты складываются вместе. Нота C2 (65 Гц), C4 (261 Гц) и C6 (1047 Гц) попадают в одну хрома-бин "C".

### Как понимать
По сути это «гармонический отпечаток» трека. Если играет аккорд Am (A-C-E), в хромаграмме будут яркие бины A, C и E.

Значение `chroma_stft_mean` — среднее по всем 12 нотам и всем фреймам. Чем выше — тем более выраженный тональный контент.

### Диапазон в датасете: ~0.17 — 0.66

| Значение | Что это значит |
|----------|---------------|
| **Высокое (0.4-0.66)** | Чёткие ноты и аккорды, выраженная гармония. Типично для jazz, classical, pop |
| **Низкое (0.17-0.3)** | Размытый тональный контент — много шума, дисторшна, или перкуссии без чёткой высоты. Бывает у metal (дисторшн размазывает гармоники), hiphop (много ударных) |

### Для гитариста
Представь: чистый аккорд Am на акустике даст высокую хрому — ноты чёткие. А тот же Am через хай-гейн усилитель с фуззом — хрома ниже, потому что дисторшн добавляет кучу обертонов и «грязи», размывая чистые ноты.

### variance (дисперсия)
Высокая дисперсия — гармония сильно менялась (частые смены аккордов, модуляции). Низкая — статичная гармония (дрон, один аккорд, повторяющийся рифф).

---

## 2. rms — Среднеквадратичная энергия (громкость)

### Что это
RMS (Root Mean Square) — корень из среднего квадрата амплитуды сигнала. Это мера **воспринимаемой громкости**. В отличие от пиковой амплитуды (самый громкий сэмпл), RMS показывает **среднюю энергию** — то, что мы реально слышим как «громко» или «тихо».

Формула: `RMS = sqrt( (1/N) * sum(x[i]^2) )`

### Как понимать
Если сигнал нормализован (амплитуда от -1 до 1), то RMS показывает, какую долю этого диапазона в среднем занимает сигнал.

### Диапазон в датасете: ~0.005 — 0.40

| Значение | Что это значит |
|----------|---------------|
| **Высокое (0.15-0.40)** | Громкая, компрессированная музыка. Metal, rock, disco, современный pop — всё «придавлено» компрессором, динамический диапазон узкий |
| **Низкое (0.005-0.08)** | Тихая или очень динамичная музыка. Classical (пианиссимо — фортиссимо), jazz-баллады, ambient |

### Для гитариста
Когда играешь фингерстайл на акустике — RMS низкий: есть тихие ноты и громкие. Когда играешь palm mute дроны через Mesa Boogie с компрессором — RMS высокий, всё ровно и громко. Это как разница между «динамика» и «стена звука».

### variance
Высокая дисперсия RMS = большая динамика (тихие и громкие моменты). Низкая = ровная громкость (компрессия, электронная музыка).

---

## 3. spectral_centroid — Спектральный центроид (яркость звука)

### Что это
Центр масс спектра — средневзвешенная частота, где весами служат амплитуды. Если представить спектр как гистограмму, центроид — это точка, в которой гистограмма «балансирует».

Формула: `centroid = sum(частота[k] * амплитуда[k]) / sum(амплитуда[k])`

Результат — частота в **герцах**.

### Как понимать
Это главный акустический коррелят **яркости** (brightness) звука. Высокий центроид = звук яркий, «резкий». Низкий = звук тёмный, «тёплый».

### Диапазон в датасете: ~570 — 4435 Гц

| Значение | Что это значит |
|----------|---------------|
| **Высокое (3000-4400 Гц)** | Яркий звук — много высоких частот. Metal (тарелки, дисторшн), electronic, pop с яркой продакшн |
| **Среднее (2000-3000 Гц)** | Сбалансированный тембр. Rock, country, jazz |
| **Низкое (570-1500 Гц)** | Тёмный, тёплый звук — доминируют басы и мид. Reggae, hiphop, classical (низкие струнные) |

### Для гитариста
Ручка Tone на гитаре — это, по сути, регулятор спектрального центроида. Tone на 10 (яркий) — центроид высокий. Tone на 0 (приглушённые высокие) — центроид низкий. Или сравни бридж-звукосниматель (яркий, высокий центроид) с нэк-звукоснимателем (тёплый, низкий центроид).

---

## 4. spectral_bandwidth — Спектральная ширина

### Что это
Если спектральный центроид — это «центр» спектра, то bandwidth — его **ширина** (разброс). Вычисляется как взвешенное стандартное отклонение частот вокруг центроида.

По сути это отвечает на вопрос: **насколько «размазан» звук по частотам?**

### Как понимать

| Значение | Что это значит |
|----------|---------------|
| **Широкий (3000-3500 Гц)** | Энергия распределена по широкому диапазону частот — звук богатый, сложный или шумный. Полная группа, дисторшн (он раздвигает спектр), тарелки, белый шум |
| **Узкий (900-1500 Гц)** | Энергия сконцентрирована в узком диапазоне — звук чистый, тональный, «фокусированный». Соло флейты, чистая гитара на одной ноте, синусоида |

### Диапазон в датасете: ~898 — 3510 Гц

### Для гитариста
Одна чистая нота на 12 ладу — узкий bandwidth (один основной тон + несколько гармоник). Аккорд на дисторшне — широкий bandwidth, потому что дисторшн генерирует интермодуляционные продукты, а каждая струна вносит свой набор гармоник. Cymbal crash — ещё шире, потому что у тарелки почти «белошумовой» спектр.

---

## 5. rolloff — Спектральный спад

### Что это
Частота (в Гц), ниже которой содержится **85% энергии** спектра. Это как «верхняя граница», до которой нужно слушать, чтобы услышать почти всё, что происходит.

### Как понимать

| Значение | Что это значит |
|----------|---------------|
| **Высокое (5000-8500 Гц)** | Много энергии в высоких частотах — яркий, «воздушный» звук. Metal, electronic, pop с яркими синтами |
| **Низкое (750-3000 Гц)** | Почти вся энергия внизу — тёмный, басовый звук. Reggae, hiphop, classical (низкие инструменты) |

### Диапазон в датасете: ~749 — 8678 Гц

### Для гитариста
Если записать гитару через хай-кат фильтр на 4 кГц (убрать всё выше) — rolloff будет где-то около 3.5 кГц. Если оставить весь спектр с дисторшном и яркими гармониками до 10 кГц — rolloff будет 7-8 кГц. По сути rolloff — это как частота среза low-pass фильтра, которая описывает «насколько далеко вверх по частотам распространяется звук».

---

## 6. zero_crossing_rate — Частота пересечения нуля

### Что это
Доля моментов, когда сигнал меняет знак (переходит через ноль) за единицу времени. Это простой **временнОй** признак (считается прямо по волновой форме, без FFT).

Чистая синусоида 100 Гц пересекает ноль 200 раз в секунду (туда и обратно). Белый шум пересекает ноль гораздо чаще.

### Как понимать

| Значение | Что это значит |
|----------|---------------|
| **Высокое (0.08-0.15)** | Сигнал быстро «мечется» — много высоких частот, шум, дисторшн. Metal (дисторшн создаёт тонны пересечений), ударные (шумовые транзиенты) |
| **Низкое (0.02-0.05)** | Сигнал плавный, тональный — доминируют низкие частоты. Classical, jazz, reggae, чистый вокал |

### Диапазон в датасете: ~0.02 — 0.15

### Для гитариста
Чистый звук на нэке = мало пересечений (плавная волна). Хай-гейн на бридж-пикапе = много пересечений (дисторшн «обрезает» волну, создавая кучу крутых фронтов и мелких осцилляций). Если играешь palm mute — ZCR будет выше, чем при открытых струнах на том же аккорде, потому что демпфирование добавляет шумовую компоненту.

---

## 7. harmony / perceptr — Гармоническая и перкуссивная составляющие

### Что это
Эти два признака получаются из **HPSS** (Harmonic-Percussive Source Separation) — алгоритма, который разделяет аудио на две части:

- **Harmony (гармоническая)** — всё, что «тянется»: мелодии, аккорды, вокал, sustained-ноты. В спектрограмме это горизонтальные линии (устойчивые частоты во времени).
- **Perceptr (перкуссивная)** — всё, что «ударяет»: барабаны, щёлчки, атака нот, стаккато. В спектрограмме это вертикальные линии (короткие всплески энергии по всем частотам одновременно).

Алгоритм работает через **медианную фильтрацию** спектрограммы: горизонтальный медианный фильтр выделяет гармонику, вертикальный — перкуссию.

### Как понимать
Значения — амплитуды разделённых сигналов (центрированы около нуля, как исходное аудио).

- **Высокая harmony** — много тональных, «тянущихся» звуков (classical, jazz, sustained guitar, пэды)
- **Высокая perceptr** — много ударных, ритмических компонентов (hiphop, disco, metal)

### Диапазон в датасете
Маленькие числа около нуля (типично ±0.01), потому что это средние амплитуды аудиосигнала.

### Для гитариста
Когда играешь аккорды с сустейном (let ring) — гармоническая компонента доминирует. Когда играешь перкуссивный фанк (чикают мёртвые ноты, чоп-стайл) — перкуссивная компонента растёт. Fingerstyle с ghost notes — микс обоих.

---

## 8. tempo — Темп (BPM)

### Что это
Оценка темпа в **ударах в минуту** (BPM). Librosa анализирует **onset strength** (моменты начала новых звуков), находит периодичность через автокорреляцию, и определяет доминирующий темп.

### Типичные BPM по жанрам

| Жанр | Типичный BPM |
|------|-------------|
| Reggae | 60-90 |
| Hip-hop | 85-95 |
| Blues | 60-120 |
| Jazz | 60-200 (от баллад до бибопа) |
| Classical | 60-140 (от адажио до аллегро) |
| Country | 100-140 |
| Pop | 100-130 |
| Rock | 110-140 |
| Disco | 118-122 (очень стабильный!) |
| Metal | 100-200 (трэш/спид до 200+) |

### Диапазон в датасете: ~60 — 244 BPM

### Нюанс
Автоматическая оценка темпа иногда ошибается в 2 раза — определяет 60 вместо 120 или 240 вместо 120 (octave error). Это нормально и добавляет шум в данные.

### Для гитариста
Если метроном стоит на 120 — это средний рок/поп-темп. 70 — медленный блюз или регги. 180 — трэш-метал или бибоп. Disco живёт на 120 BPM так стабильно, что этот признак почти однозначно отличает его от reggae или hip-hop.

---

## 9. MFCC 1-20 — Мел-частотные кепстральные коэффициенты

### Это самые важные признаки в датасете. Разберём подробно.

### Шаг за шагом: как вычисляются MFCC

**1. Разбиение на фреймы**
Аудио нарезается на короткие перекрывающиеся окна (~23 мс = 512 сэмплов при 22050 Гц). Каждый фрейм анализируется отдельно.

**2. FFT (быстрое преобразование Фурье)**
Из ЦОС помнишь — FFT переводит сигнал из временной области в частотную. Получаем спектр мощности для каждого фрейма.

**3. Мел-фильтрбанк**
Спектр пропускается через набор треугольных полосовых фильтров, расставленных по **мел-шкале**. Мел-шкала моделирует восприятие высоты звука человеком:

```
Mel(f) = 2595 * log10(1 + f/700)
```

Суть: **ниже ~1000 Гц** фильтры расставлены линейно (мы хорошо различаем 200 Гц от 300 Гц), **выше ~1000 Гц** — логарифмически (5200 Гц от 5300 Гц на слух почти одинаково). Это отражает работу улитки внутреннего уха — базилярная мембрана устроена именно так.

**4. Логарифм**
Берём логарифм энергии в каждом мел-фильтре. Это моделирует восприятие громкости: удвоение мощности звука не воспринимается как «в два раза громче».

**5. DCT (дискретное косинусное преобразование)**
Из ЦОС: DCT — это как Фурье, но для вещественных данных. Применяем DCT к лог-мел-спектру, и получаем **кепстральные коэффициенты**. DCT декоррелирует признаки (мел-фильтры перекрываются и коррелируют друг с другом) и сжимает информацию.

**6. Берём первые 20 коэффициентов** — это и есть MFCC.

### Что такое «кепстр»?
Слово «cepstrum» — это «spectrum» с перевёрнутым началом. Кепстр отделяет **спектральную огибающую** (общая форма спектра = тембр) от **тонкой структуры** (гармоники = высота тона). MFCC описывают именно огибающую — то есть **тембр**, а не конкретные ноты.

### Что означает каждый коэффициент

| Коэфф. | Что описывает | Простыми словами |
|--------|--------------|-----------------|
| **MFCC1** | Общая энергия (средний уровень лог-спектра) | «Насколько громко в целом». Это как уровень мастер-фейдера. Диапазон: примерно -600..+200 |
| **MFCC2** | Наклон спектра (баланс низ/верх) | «Больше баса или больше верхов?». Положительные — больше баса, отрицательные — больше верхов. Похоже на эквалайзер с одной ручкой |
| **MFCC3** | Середина vs края спектра | «Есть ли акцент на мидах?». Отвечает за «назальность» или «открытость» звука |
| **MFCC4-6** | Более тонкая форма спектра | Резонансы, формантоподобные структуры. Различают типы инструментов и голосов |
| **MFCC7-13** | Детали тембра | Тонкие различия в обертоновом составе. Отличают скрипку от виолончели, Fender от Gibson |
| **MFCC14-20** | Мельчайшие детали | Текстурные нюансы, «шероховатость» звука. Менее стабильны, больше подвержены шуму, но помогают различать похожие тембры |

### Ключевое: нижние vs верхние коэффициенты

- **MFCC1-5 (низкие)**: грубая форма спектра. Это как контур горного хребта — основной профиль. Самые стабильные и информативные. Хорошо разделяют сильно отличающиеся жанры.
- **MFCC6-13 (средние)**: детали формы. Как если присмотреться к горам и увидеть отдельные скалы и деревья. Помогают различать похожие жанры.
- **MFCC14-20 (высокие)**: мелкие детали. Как текстура камней на скалах. Наименее устойчивы, но добавляют точности.

### mean vs var
- **mean** — средний тембр трека за 30 секунд. «Как в среднем звучит?»
- **var** — насколько тембр менялся. Высокая дисперсия = разнообразие тембров (смена инструментов, динамика). Низкая = однородный звук.

### Для гитариста
MFCC описывают «цвет» звука. Акустическая гитара, электрогитара на чистом канале и та же гитара через Marshall — три совершенно разных набора MFCC, хотя играется один и тот же аккорд. MFCC1 будет отличаться по громкости, MFCC2 — по балансу низ/верх (Marshall ярче акустики), MFCC3-6 — по характерным резонансам корпуса/кабинета, MFCC7+ — по мелким деталям овердрайва, призвукам и т.д.

### Почему MFCC — главные признаки
1. **Моделируют слух человека** — мел-шкала + логарифм = как мы реально воспринимаем звук
2. **Описывают тембр компактно** — 20 чисел вместо тысяч частотных бинов
3. **Инвариантны к тональности** — MFCC не зависят от того, в какой тональности играет трек
4. **Относительно устойчивы к темпу** — быстрый и медленный трек с похожим инструментарием дадут похожие MFCC

---

## Сводная таблица

| Признак | Область | Что измеряет | Низкое значение | Высокое значение |
|---------|---------|-------------|-----------------|-----------------|
| `chroma_stft` | Высота тона | Тональный контент | Размытые ноты, шум | Чёткие ноты и аккорды |
| `rms` | Энергия | Громкость | Тихо, динамично | Громко, компрессировано |
| `spectral_centroid` | Частота | Яркость | Тёмный, тёплый звук | Яркий, резкий звук |
| `spectral_bandwidth` | Частота | Спектральная ширина | Чистый, тональный | Богатый, шумный, сложный |
| `rolloff` | Частота | Верхняя граница энергии | Всё внизу (басы) | Много верхов |
| `zero_crossing_rate` | Время | Шумность/нойзовость | Плавный, тональный | Шумный, дисторшн |
| `harmony` | Разложение | Гармоническая часть | Мало мелодий | Много сустейна, аккордов |
| `perceptr` | Разложение | Перкуссивная часть | Мало ударных | Много ритма, атаки |
| `tempo` | Ритм | Скорость (BPM) | Медленно (reggae, баллады) | Быстро (metal, disco) |
| `mfcc1` | Тембр | Общая энергия | Тихий трек | Громкий трек |
| `mfcc2` | Тембр | Баланс низ/верх | Яркий звук | Басовый звук |
| `mfcc3-20` | Тембр | Детали тембра | (зависит от коэфф.) | (зависит от коэфф.) |

---

## Источники

- [librosa documentation](https://librosa.org/doc/main/) — библиотека для извлечения аудиопризнаков
- Tzanetakis & Cook, 2002 — «Musical genre classification of audio signals» (оригинальная статья GTZAN)
- [Mel-frequency cepstrum — Wikipedia](https://en.wikipedia.org/wiki/Mel-frequency_cepstrum)
- [Practical Cryptography — Guide to MFCCs](http://practicalcryptography.com/miscellaneous/machine-learning/guide-mel-frequency-cepstral-coefficients-mfccs/)
